# 分布式文件系统方向选题调研



## 分布式文件系统概述

### 目前主流分布式文件系统

*删去的为未开源的*

- ~~GFS(Google)~~、HDFS（架构与GFS类似，采用java实现，还没有成熟的C++开源版本）
- HDFS
- Ceph
- Lustre
- MogileFS
- MooseFS：C实现
- FastDFS：C实现
- TFS
- GridFS

- GlusterFS：开源分布式横向扩展文件系统
- JuiceFS：使用公有云中已有的对象存储来替换 DataNode 和 ChunkServer

![image-20230322013854948](DFS调研.assets\image-20230322013854948.png)

### 相关名词

#### POSIX

可移植操作系统接口

### 按特性分类

|                        | FastDFS | GlusterFS | GridFS | Ceph | Lustre | MooseFS | GlusterFS | MogileFS |
| ---------------------- | ------- | --------- | ------ | ---- | ------ | ------- | --------- | -------- |
| 适合做通用文件系统     |         | √         |        | √    | √      | √       |           |          |
| 适合小文件存储         | √       |           |        | √    |        | √       |           | √        |
| 适合大文件存储         |         | √         | √      | √    | √      |         |           |          |
| 轻量级文件系统         | √       |           |        |      |        | √       |           |          |
| 简单易用，用户数量活跃 | √       | √         |        |      |        | √       |           | √        |
| 支持FUSE挂载           |         | √         |        | √    | √      | √       |           |          |

### FastDFS

基于互联网应用的开源分布式文件系统，主要用于大中型网站存储资源文件，如图片、文档、音频、视频等。

跟踪服务器（tracker server）+存储服务器（storage server）+客户端（client）

适用中小文件，建议4KB-500MB

采用类似GFS的架构，用纯C语言实现，支持Linux、FreeBSD、AIX等UNIX 系统。

用户端只能通过专有API对文件进行存取访问，不支持POSIX接口方式。

GFS以及 FastDFS、mogileFS、HDFS、TFS等类GFS系统都**不是系统级的分布式文件系统**，而是**应用级的分布式文件存储服务**。

缺点：

- 不支持**断点续传**，**不适合大文件存储**；
- 不支持POSIX，通用性较低；
- 对跨公网的文件同步，存在较大延迟，需要应用做相应的容错策略；
- **同步机制不支持文件正确性校验**；
- 通过API下载，存在单点的性能瓶颈

- 写一份即成功：从源storage写完文件至同步到组内其他storage的时间窗口内，一旦源storage出现故障，就可能导致用户数据丢失，而数据的丢失对存储系统来说通常是不可接受的。

- 缺乏自动化恢复机制：当storage的某块磁盘故障时，只能换存磁盘，然后手动恢复数据；由于按机器备份，似乎也不可能有自动化恢复机制，除非有预先准备好的热备磁盘，缺乏自动化恢复机制会增加系统运维工作。
- 数据恢复效率低：恢复数据时，只能从group内其他的storage读取，同时由于小文件的访问效率本身较低，按文件恢复的效率也会很低，低的恢复效率也就意味着数据处于不安全状态的时间更长。
- 缺乏多机房容灾支持：目前要做多机房容灾，只能额外做工具来将数据同步到备份的集群，无自动化机制。

存储空间利用率

- 单机存储的文件数受限于inode数量
- 每个文件对应一个storage本地文件系统的文件，平均每个文件会存在block_size/2的存储空间浪费。
- 文件合并存储能有效解决上述两个问题，但由于**合并存储没有空间回收机制**，删除文件的空间不保证一定能复用，也存在空间浪费的问题

负载均衡

- group机制本身可用来做负载均衡，但这只是一种静态的负载均衡机制，需要预先知道应用的访问特性；同时group机制也导致不可能在group之间迁移数据来做动态负载均衡。

### Ceph

- 分层结构

  底层是一个基于CRUSH（哈希）的分布式对象存储，上层提供对象存储（RADOSGW）、块存储（RDB）和文件系统（CephFS）三个API

- 整体结构：

<img src="DFS调研.assets\image-20230322013540253.png" alt="image-20230322013540253" style="zoom:80%;" />

### 有待进一步调查的选题方向

#### 基于FastDFS+Redis的分布式文件存储系统及方法

![image-20230322015458379](DFS调研.assets\image-20230322015458379.png)



#### 群智感知环境下的分布式文件系统的设计与实现

现有的分布式文件系统大多采用集中式的元数据管理策略，集中式的元数据管理策略不适用于群智感知环境下海量的小文件产生的海量元数据量。群智感知要求分布式文件系统能高效地支持大小文件混存。设计并实现了一个分布式元数据服务器的、同时支持大小文件存储的分布式文件系统。

- 找到的资料很少